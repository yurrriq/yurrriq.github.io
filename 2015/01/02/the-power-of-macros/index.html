
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>#'clojure.core/some-&gt; and the Power of Macros</title>
    <meta name="description" content="Homoiconicity, and metaprogramming, and macros! Oh my! In 2015, my love for these elegant weapons will undoubtedly grow fonder.">

    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="shortcut icon" href="../../../../favicon.ico">

    <link rel="stylesheet" type="text/css" href="../../../../assets/css/screen.css?v=6068351e2b">
    <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic%7COpen+Sans:700,400">
    <link rel="stylesheet" type="text/css" href="../../../../assets/css/prism.min.css?v=6068351e2b">

    <link rel="canonical" href="http://blog.ericb.me/2015/01/02/the-power-of-macros/">
    
    <meta property="og:site_name" content="i can haz blog?">
    <meta property="og:type" content="article">
    <meta property="og:title" content="#'clojure.core/some-&gt; and the Power of Macros">
    <meta property="og:description" content="Homoiconicity, and metaprogramming, and macros! Oh my! In 2015, my love for these elegant weapons will undoubtedly grow fonder....">
    <meta property="og:url" content="http://blog.ericb.me/2015/01/02/the-power-of-macros/">
    <meta property="article:published_time" content="2015-01-03T00:45:25.647Z">
    <meta property="article:modified_time" content="2015-01-03T01:02:58.986Z">
    
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="#'clojure.core/some-&gt; and the Power of Macros">
    <meta name="twitter:description" content="Homoiconicity, and metaprogramming, and macros! Oh my! In 2015, my love for these elegant weapons will undoubtedly grow fonder....">
    <meta name="twitter:url" content="http://blog.ericb.me/2015/01/02/the-power-of-macros/">
    
    <script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Article",
    "publisher": "i can haz blog?",
    "author": {
        "@type": "Person",
        "name": "Eric Bailey",
        "image": "//www.gravatar.com/avatar/527cc023ca1a56c9072424f7c44ab118?d=404&s=250",
        "url": "http://blog.ericb.me/author/eric",
        "sameAs": "https://github.com/yurrriq"
    },
    "headline": "#&#x27;clojure.core/some-&gt; and the Power of Macros",
    "url": "http://blog.ericb.me/2015/01/02/the-power-of-macros/",
    "datePublished": "2015-01-03T00:45:25.647Z",
    "dateModified": "2015-01-03T01:02:58.986Z",
    "description": "Homoiconicity, and metaprogramming, and macros! Oh my! In 2015, my love for these elegant weapons will undoubtedly grow fonder...."
}
    </script>

    <meta name="generator" content="Ghost 0.5">
    <link rel="alternate" type="application/rss+xml" title="i can haz blog?" href="http://blog.ericb.me/rss/">
</head>
<body class="post-template">

    


<header class="main-header post-head no-cover">
    <nav class="main-nav  clearfix">
        <a class="back-button icon-arrow-left" href="http://blog.ericb.me">Home</a>
        <a class="subscribe-button icon-feed" href="http://blog.ericb.me/rss/">Subscribe</a>
    </nav>
</header>

<main class="content" role="main">

    <article class="post">

        <header class="post-header">
            <h1 class="post-title">#'clojure.core/some-&gt; and the Power of Macros</h1>
            <section class="post-meta">
                <time class="post-date" datetime="2015-01-02">02 January 2015</time> 
            </section>
        </header>

        <section class="post-content">
            <p><a href="http://calculist.org/blog/2012/04/17/homoiconicity-isnt-the-point/" target="_blank">Homoiconicity</a>, and <a href="https://twitter.com/yurrriq/status/536036269222936576" target="_blank">metaprogramming</a>, and <a href="http://learnxinyminutes.com/docs/clojure-macros/" target="_blank">macros</a>! Oh my!</p>

<p>In 2015, my love for these <a href="http://xkcd.com/297/" target="_blank">elegant weapons</a> will undoubtedly <a href="https://twitter.com/yurrriq/status/525703812833890305" target="_blank">grow fonder</a>.</p>

<pre><code class="language-clojure">(comment
  ;; #'clojure.core/some-&gt; is one my favorite Clojure macros.
  (some-&gt; (meta #'clojure.core/some-&gt;) :doc println)
  ;; When expr is not nil, threads it into the first form (via -&gt;),
  ;; and when that result is not nil, through the next etc

  (macroexpand '(some-&gt; (meta #'clojure.core/some-&gt;) :doc println))

  (let* [G__2986 (meta (var clojure.core/some-&gt;))
         G__2986 (if (clojure.core/nil? G__2986)
                   nil
                   (clojure.core/-&gt; G__2986 :doc))
         G__2986 (if (clojure.core/nil? G__2986)
                   nil
                   (clojure.core/-&gt; G__2986 println))]
    G__2986)

  ;; Rewritten more readably to illustrate the point:
  (let [example (meta #'clojure.core/some-&gt;)
        example (when-not (nil? example)
                  (:doc example))
        example (when-not (nil? example)
                  (println example))]
    example)

  ;; Which brings me to another of my scattered thoughts,
  ;; Clojure has the #'clojure.core/when-not macro, but
  ;; for some reason, I find myself wanting to use 'unless,
  ;; as in Common Lisp:
  (defmacro unless (condition &amp;rest body)
    `(if (not ,condition) (progn ,@body)))

  ;; What better excuse to start writing my own macros?
  (ns fastidious.macros)

  (defmacro unless
    [condition &amp; body] `(if (not ~condition) (do ~@body)))

  ;; Side bonus: I used my desire for 'unless to drive
  ;; my experiments in integrating macros in ClojureScript,
  ;; with underwhelming success. It just works.
  (ns client.core
    (:require-macros [fastidious.macros :refer [unless]]))

  (let [lisp-is-lame? false]
    (unless lisp-is-lame?
      (println "IFL Lisp.")
      (println "Next up: /c[ad]{1,5}r/"))))
</code></pre>

<p>See also: <a href="https://github.com/clojure/clojure/blob/28509b8caa95537cddd31152b7603de4d866c951/src/clj/clojure/core.clj#L7204-L7213" target="_blank"><code>#'clojure.core/some-&gt;</code></a> source on GitHub</p>
        </section>

        <footer class="post-footer">


            <figure class="author-image">
                <a class="img" href="../../../../author/eric/" style="background-image: url(http://www.gravatar.com/avatar/527cc023ca1a56c9072424f7c44ab118?d=404&amp;s=250)"><span class="hidden">Eric Bailey's Picture</span></a>
            </figure>

            <section class="author">
                <h4><a href="../../../../author/eric/">Eric Bailey</a></h4>

                    <p>Mad computer scientist, Lisp zealot, serial insomniac, champion of caffeine and capsaicin, guitarist of Naptaker.</p>
                <div class="author-meta">
                    <span class="author-location icon-location">Minneapolis, MN</span>
                    <span class="author-link icon-link"><a href="https://github.com/yurrriq">https://github.com/yurrriq</a></span>
                </div>
            </section>


            <section class="share">
                <h4>Share this post</h4>
                <a class="icon-twitter" href="https://twitter.com/share?text=%23'clojure.core%2Fsome-%3E%20and%20the%20Power%20of%20Macros&amp;url=http://blog.ericb.me/2015/01/02/the-power-of-macros/" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <span class="hidden">Twitter</span>
                </a>
                <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://blog.ericb.me/2015/01/02/the-power-of-macros/" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <span class="hidden">Facebook</span>
                </a>
                <a class="icon-google-plus" href="https://plus.google.com/share?url=http://blog.ericb.me/2015/01/02/the-power-of-macros/" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <span class="hidden">Google+</span>
                </a>
            </section>

        </footer>

    </article>

</main>



    <footer class="site-footer clearfix">
         <section class="copyright"><a href="http://blog.ericb.me">i can haz blog?</a> Â© 2015</section>
         <section class="poweredby">Proudly published with <a href="https://ghost.org">Ghost</a></section>
    </footer>

    <script src="../../../../public/jquery.js?v=6068351e2b"></script>

    <script type="text/javascript" src="../../../../assets/js/jquery.fitvids.js?v=6068351e2b"></script>
    <script type="text/javascript" src="../../../../assets/js/index.js?v=6068351e2b"></script>
    <script type="text/javascript" src="../../../../assets/js/prism.min.js?v=6068351e2b"></script>
    <script type="text/javascript" src="../../../../assets/js/prism.clojure.js?v=6068351e2b"></script>

</body>
